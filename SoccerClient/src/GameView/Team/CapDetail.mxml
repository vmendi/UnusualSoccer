<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" creationComplete="CreationCompleteHandler(event)" xmlns:GameView="GameView.*">
	
	<fx:Style source="../styles.css" />
	
	<fx:Script><![CDATA[
		import GameModel.SoccerPlayerQuality;
		import GameModel.TeamModel;
		
		import SoccerServer.TransferModel.vo.SoccerPlayer;
		
		import mx.binding.utils.BindingUtils;
		import mx.events.FlexEvent;
		
		[Bindable]
		public function get TheSoccerPlayer() : SoccerPlayer { return mSoccerPlayer; }
		public function set TheSoccerPlayer(v:SoccerPlayer) : void 
		{ 
			mSoccerPlayer = v;
			TheSoccerPlayerQuality = new SoccerPlayerQuality(mSoccerPlayer);
		}
				
		protected function CreationCompleteHandler(event:FlexEvent):void
		{			
			BindingUtils.bindSetter(OnQualityRefreshed, this, [ "TheSoccerPlayerQuality", "Quality"]);
		}
		
		private function OnQualityRefreshed(v:Number) : void
		{
			// De momento solo podriamos mostrar soccerplayers de nuestro equipo, no hay forma de obtener el
			// PredefinedTeam de un SoccerPlayer arbitrario
			(MyCapMC.content as MovieClip).gotoAndStop(SoccerClient.GetMainGameModel().TheTeamModel.PredefinedTeamName);
			
			var qual : int = TheSoccerPlayerQuality.Quality;
			var mc : MovieClip = MyCapStars.content["mcStars"] as MovieClip; 
			mc.gotoAndStop(qual+1);
		}
	
		private var mSoccerPlayer : SoccerPlayer;
		
		[Bindable] 
		public function  get TheSoccerPlayerQuality() : SoccerPlayerQuality { return mSoccerPlayerQuality; }
		private function set TheSoccerPlayerQuality(v:SoccerPlayerQuality) : void { mSoccerPlayerQuality = v; }
		private var mSoccerPlayerQuality : SoccerPlayerQuality;

	]]></fx:Script>
	
	<fx:Declarations>
		<s:GlowFilter id="DorsalNumberStrokeFilter" blurX="2" blurY="2" strength="10" quality="3" color="0x000000" />
	</fx:Declarations>	

	<s:Graphic>
		<s:BitmapImage source="@Embed(source='/Assets/General.swf', symbol='PlayerDetailBg')" fillMode="clip" />
	</s:Graphic>	
	
	<s:Group left="10" top="10" width="59" height="59">
		<mx:Image top="29" left="29" id="MyCapMC" scaleContent="false"
						  source="@Embed(source='/Assets/General.swf', symbol='CapDetail')" />
		<s:Label text="{TheSoccerPlayer.DorsalNumber.toString()}" horizontalCenter="0" top="18" styleName="whiteBoldBig" textAlign="center" filters="{DorsalNumberStrokeFilter}"/>
	</s:Group>
	
	<GameView:FacebookPicture FacebookID="{TheSoccerPlayer.FacebookID}" />
	<s:Label text="{TheSoccerPlayer.Name}" left="75" top="23" styleName="whiteBoldMedium" />
		
	<mx:Image left="74" top="26" id="MyCapStars" scaleContent="false"
			  source="@Embed(source='/Assets/General.swf', symbol='CapDetailsStars')"/>
	
	<s:Label text="{TheSoccerPlayerQuality.Quality}" left="164" top="26" styleName="whiteBoldMedium" />
	
</s:Group>
